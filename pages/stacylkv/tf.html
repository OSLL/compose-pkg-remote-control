<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="http://static.robotwebtools.org/EventEmitter2/current/eventemitter2.min.js"></script>
    <script src="http://static.robotwebtools.org/roslibjs/current/roslib.min.js"></script>

    <script type="text/javascript" type="text/javascript">
        var ros = new ROSLIB.Ros({
            url: 'ws://autolab.moevm.info/dashboard/websocket/autobot01'
        });

        var tfClient = new ROSLIB.TFClient({
            ros: ros,
            fixedFrame: 'world',
            angularThres: 0.01,
            transThres: 0.01
        });

        tfClient.subscribe('turtle1', function (tf) {
            console.log(tf);
        });

        ros.on('connection', function () {
            console.log(this);
            console.log(arguments);
            console.log('Connected to websocket server.');
        });

        ros.on('error', function (error) {
            console.log('Error connecting to websocket server: ', error);
        });

        ros.on('close', function () {
            console.log('Connection to websocket server closed.');
        });

        /* Publishing a Topic */

        var cmdVel = new ROSLIB.Topic({
            ros: ros,
            name: '/cmd_vel',
            messageType: 'geometry_msgs/Twist'
        });

        var twist = new ROSLIB.Message({
            linear: {
                x: 0.1,
                y: 0.2,
                z: 0.3
            },
            angular: {
                x: -0.1,
                y: -0.2,
                z: -0.3
            }
        });
        cmdVel.publish(twist);

        /* Subscribing to a Topic */

        var listener = new ROSLIB.Topic({
            ros: ros,
            name: '/listener',
            messageType: 'std_msgs/String'
        });

        listener.subscribe(function (message) {
            console.log('Received message on ' + listener.name + ': ' + message.data);
            listener.unsubscribe();
        });

        /* Calling a service */

        var addTwoIntsClient = new ROSLIB.Service({
            ros: ros,
            name: '/add_two_ints',
            serviceType: 'rospy_tutorials/AddTwoInts'
        });

        var request = new ROSLIB.ServiceRequest({
            a: 1,
            b: 2
        });

        addTwoIntsClient.callService(request, function (result) {
            console.log('Result for service call on '
                + addTwoIntsClient.name
                + ': '
                + result.sum);
        });

        /* Getting and setting a param value */

        ros.getParams(function (params) {
            console.log(params);
        });

        var maxVelX = new ROSLIB.Param({
            ros: ros,
            name: 'max_vel_y'
        });

        maxVelX.set(0.8);
        maxVelX.get(function (value) {
            console.log('MAX VAL: ' + value);
        });
    </script>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        h1 {
            color: #9999FF;
        }

        p {
            color: #CCCCFF;
        }
    </style>
</head>
<body>
<h1>Simple Example</h1>
<p>Check the <b>JavaScript console</b> for the output.</p>
</body>
</html>